<!DOCTYPE html>
<html>
<head>
  <title>ГРА «ЗНАЙДИ ШКІЛЬНУ СВОЮ ФІНАНСОВУ АВТОНОМІЮ</title>
  <link rel="stylesheet/less" href="./style.less"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/less.js/3.9.0/less.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>
<body>
<div id='app'>
  <div class="slides">

    <div v-if="numberSlides<14" class="next">
      <button class="nextSlide" @click="changeSlide">ДАЛІ</button>

    </div>
    <div v-if="numberSlides===1" class="slide-1">
      1
    </div>

    <div v-if="numberSlides===2" class="slide-2">
      2
    </div>

    <div v-if="numberSlides===3" class="slide-3">
      3 Начальниця управління освіти, у якої в голові питання
    </div>
    <div v-if="numberSlides===4" class="slide-4">
      4
    </div>
    <div v-if="numberSlides===5" class="slide-5">
      5
      <button @click="changeSlide" class="exit">Вихід є</button>

    </div>
    <div v-if="numberSlides===6" class="slide-6">
      6 Підказка: складіть пазл (оберіть пазли, які потрібно поміняти місцями)
      <div class="skrynya">
        <div @click="selectImage" id="skrynya2" class="skrynya1 top-right"></div>
        <div @click="selectImage" id="skrynya3" class="skrynya3 bottom-right"></div>
        <div @click="selectImage" id="skrynya1" class="skrynya4 top-left"></div>
        <div @click="selectImage" id="skrynya4" class="skrynya2 bottom-left"></div>
      </div>
    </div>
    <div v-if="numberSlides===7" class="slide-7">
      7 Підказка: візьміть ключ, відімкніть замок
      <div class="doors">
        <div class="door door-left"></div>
        <div class="door door-right"></div>
        <img src="images/lock.png" @click="selectLock('lock')" class="lock">
      </div>

    </div>
    <div v-if="numberSlides===8" class="slide-8">
      8
    </div>
    <div v-if="numberSlides===9" class="slide-9">
      9 СМУГА ПЕРЕШКОД
      <div class="small-blocking">
        <img src="images/truby.png">
        <img src="images/fire.png">
        <img src="images/rock.png">
      </div>

    </div>
    <div v-if="numberSlides===10" class="slide-10">
      <img src="images/rock.png" class="blocking">
      <div v-for="q,qIndex in questions.s10" :key="q.question" class="test">
        {{q.question}}
        <div v-for="ans,aIndex in q.allAnswers"
             :key="ans.title"
             :title="ans.title">
          <label>
            <input type="checkbox"
                   :value="ans.value"
                   @change="controlAnswer(qIndex,aIndex,'s10')"
                   v-model="answers.s10[qIndex]">{{ans.title}}
          </label>
        </div>
      </div>
    </div>
    <div v-if="numberSlides===11" class="slide-11">
      <div class="admin-school">
        <img v-if="howFoundKeys===1" src="images/fire.gif" height="50px">
        <h1 class="text-fire">АДМІНІСТРАЦІЯ ШКОЛИ</h1>
        <img v-if="howFoundKeys===1" src="images/fire.gif" height="50px">
      </div>
      <div v-for="q,qIndex in questions.s11" :key="q.question" class="test">
        {{q.question}}
        <div v-for="ans,aIndex in q.allAnswers"
             :key="ans.title"
             :title="ans.title">
          <label>
            <input type="checkbox"
                   :value="ans.value"
                   @change="controlAnswer(qIndex,aIndex,'s11')"
                   v-model="answers.s11[qIndex]">{{ans.title}}
          </label>
        </div>
      </div>
      <div class="blocking">
        <img src="images/fire.png">
      </div>
      <!--      <img src="https://i.gifer.com/9PrD.gif" height="300px" class="fire-left">-->
      <!--      <img src="images/fire.gif" height="400px" class="fire-right">-->
    </div>

    <div v-if="numberSlides===12" class="slide-12">
      <div v-for="q,qIndex in questions.s12" :key="q.qIndex" class="test">
        {{q.question}}
        <div v-for="ans,aIndex in q.allAnswers"
             :key="ans.title"
             :title="ans.title">
          <label>
            <input type="checkbox" :value="ans.value" @change="controlAnswer(qIndex,aIndex,'s12')"
                   v-model="answers.s12[qIndex]">{{ans.title}}
          </label>
        </div>
      </div>
      <div class="blocking">
        <img src="images/truby.png">
      </div>
    </div>
    <div v-if="numberSlides===13" class="slide-13">
      <h1>Відімкніть скриню ключами</h1>
        <div>
          <img src="images/sunduk.png">
          <div class="box">
            <div>
              <img src="images/lock.png" @click="selectLock('lock1')" class="lock1">
            </div>
            <div>
              <img src="images/lock.png" @click="selectLock('lock2')" class="lock2">
            </div>
            <div>
              <img src="images/lock.png" @click="selectLock('lock3')" class="lock3">
            </div>
          </div>
        </div>

    </div>
    <div v-if="numberSlides>13" id="gifts" class="fadeIn">
      <img src="images/gift.png">
    </div>
    <div class="overlay hidden">
    </div>

  </div>
  <div v-if="numberSlides>5 && numberSlides<14" class="keys" id="key" @click="giveKey">
    <keys :foundkeys="howFoundKeys"></keys>
  </div>
</div>

<script src="js/keys.js"></script>
<script>

  const questions = {

    s10: [
      {
        question: "1. Хто такий засновник школи?",
        correctAnswers: [3],
        allAnswers: [
          {
            title: 'директор школи',
            value: 1
          },
          {
            title: 'батьківський комітет',
            value: 2
          },
          {
            title: 'місцева рада депутатів',
            value: 3
          },
          {
            title: 'управління / відділ освіти',
            value: 4
          }
        ]
      },
      {
        question: "2. Які документи має ухвалити засновник?",
        correctAnswers: [1, 2],
        allAnswers: [
          {
            title: 'рішення про переведення шкіл на фінансову автономію',
            value: 1
          },
          {
            title: 'положення про утворення, організацію діяльності та ліквідацію Піклувальних ' +
              '(Наглядових) рад середніх навчальних закладів комунальної форми власності',
            value: 2
          },
          {
            title: 'рішення про ведення окремої бухгалтерії у школах',
            value: 3
          },
          {
            title: 'рішення про створення комунального підприємства «Піклувальна (Наглядова) рада»',
            value: 4
          }
        ]
      },
    ],
    s11: [
      {
        question: "1. Чи допоможе фінансова автономія залучити кошти із різних джерел?",
        correctAnswers: [1],
        allAnswers: [
          {
            title: 'так',
            value: 1
          },
          {
            title: 'ні',
            value: 2
          },
          {
            title: 'не знаю',
            value: 3
          },
        ]
      },

      {
        question: "2. Що робити, щоб фінансова автономія запрацювала?",
        correctAnswers: [1, 2, 3, 4],
        allAnswers: [
          {
            title: 'сформувати стратегію розвитку школи на 3-5 років',
            value: 1
          },
          {
            title: 'провести конкурс до піклувальних (наглядових) рад',
            value: 2
          },
          {
            title: 'налагодити спілкування із громадою',
            value: 3
          },
          {
            title: 'розказувати про діяльність школи',
            value: 4
          },
        ]
      },
      {
        question: "3. Яка роль піклувальної (наглядової) ради школи?",
        correctAnswers: [1, 2, 3],
        allAnswers: [
          {
            title: 'допомагати школі писати стратегію розвитку',
            value: 1
          },
          {
            title: 'допомагати залучати ресурси',
            value: 2
          },
          {
            title: 'контролювати діяльність адміністрації школи',
            value: 3
          }
        ]
      },
    ],
    s12: [
      {
        question: "1. Де взяти гроші?",
        correctAnswers: [1, 2, 3, 4, 5, 6, 7, 8, 9],
        allAnswers: [
          {
            title: 'державний бюджет',
            value: 1
          },
          {
            title: 'місцевий бюджет',
            value: 2
          },
          {
            title: 'гранти вітчизняних і міжнародних організацій',
            value: 3
          },
          {
            title: 'плата за надання навчальних та інших послуг',
            value: 4
          },
          {
            title: 'плата за науково-дослідні роботи',
            value: 5
          },
          {
            title: 'доходи від реалізації продукції',
            value: 6
          },
          {
            title: 'дивіденди від цінних паперів',
            value: 7
          },
          {
            title: 'добровільні внески',
            value: 8
          },
          {
            title: 'інші джерела, не заборонені законодавством',
            value: 9
          }
        ]
      },

      {
        question: "2. Хто допоможе залучити фінансування?",
        correctAnswers: [1],
        allAnswers: [
          {
            title: 'піклувальна (наглядова) рада',
            value: 1
          },
          {
            title: 'батьки',
            value: 2
          },
          {
            title: 'батьківські комітети',
            value: 3
          },
          {
            title: 'управління освіти',
            value: 4
          },
          {
            title: 'депутати місцевих рад',
            value: 5
          }
        ]
      },
    ],
  };

  let t = new Vue({
    el: '#app',
    data() {
      return {
        controlSlide: false,
        currentKey: 0,
        useKey: 0,
        numberSelect: 0,
        arrayImages: [],
        numberSlide: 1,
        foundkeys: 0,
        answers: {
          s10: {
            0: [], 1: []
          },
          s11: {
            0: [], 1: [], 2: []
          },
          s12: {
            0: [], 1: []
          }
        },
        questions,
      }
    },
    computed: {
      howFoundKeys() {
        return this.foundkeys;
      },
      numberSlides() {
        return this.numberSlide;
      }
    },
    methods: {
      changeSlide() {
        if (this.numberSlide < 6|| (this.controlSlide)  ||
          // (this.numberSlide === 6 && this.foundkeys === 1)||
          // (this.numberSlide === 7 && this.foundkeys !== 1)||
          this.numberSlide === 8 || this.numberSlide === 9) {
          const tempSlide = document.querySelector(".slide-" + this.numberSlide);
          tempSlide.classList.add('hidden-slide');
          const overlay = document.querySelector(".overlay");
          overlay.classList.remove('hidden');
          setTimeout(() => overlay.classList.add('hidden'), 2000);
          this.numberSlide++;
          this.controlSlide=false;
        } else {
          if (this.numberSlide > 9) {
            alert("Ви вказали не всі правильні відповіді");
          }
          if (this.numberSlide === 6) {
            alert("Складіть правильно пазл")
          }
          if (this.numberSlide === 13) {
            alert("Щоб відімкнути скриню використайте ключі")
          }
        }
      },

      selectImage(e) {
        this.numberSelect++;
        this.arrayImages.push(e.target.id);
        if (this.numberSelect === 2) {
          this.changeImages();
          this.numberSelect = 0;
        } else {
          // alert("вкажіть - з яким елементом поміняти місцями");
        }
      },
      changeImages() {
        let el1 = document.getElementById(this.arrayImages[0]);
        let el2 = document.getElementById(this.arrayImages[1]);
        let temp = [...el1.classList].find(e => e.startsWith('skrynya'));
        let temp2 = [...el2.classList].find(e => e.startsWith('skrynya'));
        el1.classList.replace(temp, temp2);
        el2.classList.replace(temp2, temp);
        this.arrayImages = [];
        this.controlSkryni();
      },
      controlSkryni() {
        this.controlSlide = true;
        for (let i = 1; i < 4; i++) {
          let id = "skrynya" + i;
          let el = document.getElementById(id);
          if (!el.className.includes(id)) {
            this.controlSlide = false;
          }
        }
        if (this.controlSlide) {
          this.foundkeys = 1;
          setTimeout(() => {
            alert("Ви знайшли ключ. Можна йти далі");
            // this.changeSlide();
          }, 2000);
        }
      },
      giveKey() {
        this.useKey++;
        // this.foundkeys--;
      },
      selectLock(nameLock) {
        console.log("select ");
        if (this.useKey > 0) {
          this.openLock(nameLock);
          if (this.numberSlide === 7) {
            this.openDoor();
            alert("Ви відкрили двері. Можна йти далі");
            this.controlSlide=true;
          } else {
            alert("Ви відімкнули замок")
          }
          // this.changeSlide();
          this.foundkeys--;
          this.useKey--;
          if (this.numberSlide===13 && this.foundkeys===0) {
            this.numberSlide=14;
          }
        } else {
          alert("Візьміть ключ");
        }
      },
      openDoor() {
        let temp1 = document.getElementsByClassName("door");
        for (let i = 0; i < temp1.length; i++) {
          temp1[i].classList.add("open");
        }
      },
      openLock(nameLock) {
        let lock = document.getElementsByClassName(nameLock);
        lock[0].classList.add("hidden-lock");
      },
      controlAnswer(index1, index2, slideNumber) {
        this.controlSlide = true;
        for (let k = 0; k < questions[slideNumber].length; k++) {
          let arr2 = questions[slideNumber][k].correctAnswers;
          let arr1 = this.answers[slideNumber][k];
          if (JSON.stringify(arr1.sort()) !== JSON.stringify(arr2.sort())) {
            this.controlSlide = false;
          }
        }
        if (this.controlSlide) {
          this.foundkeys++;
          let blocking = document.getElementsByClassName("blocking");
          blocking[0].classList.add("blocking-out");
          if (this.numberSlide === 11) {
            let text = document.querySelector(".text-fire");
            text.classList.replace("text-fire", "text-without-fire");
            let blockText = document.getElementsByClassName("admin-school");
            blockText[0].classList.replace("admin-school", "admin-school-without-fire");
          }
          setTimeout(() => {
            alert("Ви знайшли ключ. Можна йти далі");
          }, 300);
        }
      },
    }
  })

</script>
</body>
</html>

